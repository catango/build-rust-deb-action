#!/bin/sh

set -eu
. ./build.env

PKG_CONFIG_LIBDIR="/usr/lib/$(dpkg-architecture -a "$INPUT_TARGET_ARCH" -qDEB_HOST_GNU_TYPE)"
export PKG_CONFIG_LIBDIR

if [ -n "$INPUT_RUST_FEATURES" ]; then
    INPUT_RUST_FEATURES="-- --features $(echo "$INPUT_RUST_FEATURES" | sed "s/[[:blank:]]*$//;s/ /,/g")"
fi

cd -- "$INPUT_SOURCE_DIR"
echo "Target: ${RUST_TARGET}"
echo "Features: ${INPUT_RUST_FEATURES}"
exit 1

cargo deb --separate-debug-symbols ${RUST_TARGET} ${INPUT_RUST_FEATURES}
